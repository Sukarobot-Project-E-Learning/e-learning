name: Test Token

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - name: Check token
        env:
          TOKEN: ${{ secrets.PROD_REPO_TOKEN }}
        run: |
          echo "Token exists: $([[ -n "$TOKEN" ]] && echo 'YES' || echo 'NO')"
          echo "Token length: ${#TOKEN}"
          echo "Token starts with: ${TOKEN:0:4}"
          
          # Test if token works with API
          response=$(curl -s -o /dev/null -w "%{http_code}" \
            -H "Authorization: token ${TOKEN}" \
            https://api.github.com/repos/Sukarobot-Project-E-Learning/sukarobot-elearning-demo)
          
          echo "API response code: $response"
          
          if [ "$response" = "200" ]; then
            echo "✓ Token works with API"
          else
            echo "✗ Token failed API test"
          fi